[TOC]

# kettle cdc

kettle cdc

cdc:(change data capture)变化数据捕获;etl过程的第一步就是从不同的数据源抽取数据并把数据存储到数据缓存区中，这个过程的主挑战就是初始加载的数据量大和比较慢的网络延迟。完成第一步，那么我们只需要抽取变化的数据

时间戳

假设源数据存在时间戳或者递增序列，我们可以基于该字段判断是否需要插入更新

缺陷：1、中间过程中多次插入更新，只能同步最后一次更新

​    2、删除记录；在源数据被删除时，不能捕获删除数据的操作

​    3、不是实时性数据加载

此方案使用场景是轨迹表，最好轨迹表是不会被修改的，如交通卡口过车轨迹，铁路卡口验票

方案略过

触发器

源数据不存在时间戳或者序列的话，如果数据库可以支持建立触发器。使用触发器来检测数据流向

缺陷：1、对数据库的压力特变大，尤其是对于业务库来说

改进方案：如果该数据库支持复制功能，可以将数据复制到临时库，在临时库下建立触发器

方案略过

方案小批量，或者测试数据是否按照我们的预期更改

快照表

既不使用时间戳，也不使用触发器方式，可以使用快照表。

一次性抽取源数据到临时库下的某表，下一次操作需要将源数据同步到临时库的第二张某表，两个表互比，比较出变化

此方案使用场景：数据量不大，且数据表重要

[merge_DDL.ktr](../img_src/6DE00652E7714F7DB80CD3BBDDB14209/merge_DDL.ktr)

日志

略过，这种方式要花钱